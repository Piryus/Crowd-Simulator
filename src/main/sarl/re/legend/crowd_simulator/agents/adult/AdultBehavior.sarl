package re.legend.crowd_simulator.agents.adult

import com.badlogic.gdx.math.Vector2
import java.util.Random
import re.legend.crowd_simulator.agents.events.Perception
import re.legend.crowd_simulator.behaviors.AdultState
import re.legend.crowd_simulator.entities.gameobjects.Shop

/** 
 * Defines an adult's behavior
 */
behavior AdultBehavior {
	uses AdultCapacity

	var rand = new Random
	var state = AdultState::WAITING

	on Perception [state == AdultState::WAITING] {
		var shops = occurrence.shops
		
		// Select a shop from the list randomly
		var randomFemaleShop : Shop
		do {
			randomFemaleShop = shops.get(rand.nextInt(shops.size))
		} while (!randomFemaleShop.id.contains("F"))

		// Selects an entrance randomly
		var entrances = randomFemaleShop.getEntrances
		var entranceTarget = entrances.get(rand.nextInt(entrances.size))
		
		// Sets the 
		occurrence.body.target = entranceTarget
		
		moveAlongPath(occurrence.body, occurrence.waypoints)
		
		state = AdultState::WALKING_TO_SHOP;
	}

	on Perception [state == AdultState::WALKING_TO_SHOP] {
		moveAlongPath(occurrence.body, occurrence.waypoints)
	}

	on Perception [state == AdultState::PICK_UP_PRODUCT] {
	}

	on Perception [state == AdultState::EVACUATING] {
	}

}
